# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

name: $(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)

trigger:
- main

pool:
  vmImage: windows-latest

variables:
- name: var1
  value: 'var1'
- name: mySecret
  value: $(secret.Sauce)

steps:
- pwsh: ./setvars.ps1
- task: PowerShell@2
  inputs:
    filePath: './helloworld.ps1'
    arguments: '-sauceArgument "$(sauce)" -secretSauceArgument "$(secret.Sauce)"'
# - pwsh: ./VersionAssemblies.ps1
- pwsh: echo $(Build.BuildNumber) //output updated build number


- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: |
      # Write your PowerShell commands here.

      Write-Host No problem reading $env:SAUCE
      Write-Host But I cannot read $env:SECRET_SAUCE
      Write-Host I can read var1: $(var1)
      Write-Host Can I read mySecret? $(mySecret)
      Write-Host Can I read secret.sauce? $(secret.Sauce)
